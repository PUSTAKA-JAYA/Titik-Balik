<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flipbook</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="js/turn.js"></script>
</head>
<body>
    <header>
        <img src="path/to/your/header-image.jpg" alt="Header Image">
    </header>
    <div class="flipbook-viewport">
        <div class="container">
            <div class="flipbook">
                <!-- Pages will be inserted here -->
            </div>
            <div class="controls">
                <button id="prev">Previous</button>
                <button id="fullscreen-toggle">
                    <img src="path/to/fullscreen-icon.png" alt="Fullscreen" class="icon">
                </button>
                <button id="next">Next</button>
            </div>
            <div class="overlay"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var flipbook = document.querySelector('.flipbook');
            var header = document.querySelector('header');
            var controls = document.querySelector('.controls');
            var overlay = document.querySelector('.overlay');
            var isControlsVisible = true;

            for (var i = 1; i <= 68; i++) {
                var page = document.createElement('div');
                page.classList.add('page');
                page.innerHTML = '<img src="images/page' + i + '.jpg" class="flip-img"><div class="page-footer">' + i + '</div>';
                flipbook.appendChild(page);
            }

            function resizeFlipbook() {
                var headerHeight = $('header').outerHeight();
                var viewportWidth = $(window).width();
                var viewportHeight = $(window).height() - headerHeight;
                var flipbookWidth = viewportWidth;
                var flipbookHeight = viewportHeight;

                $('.flipbook-viewport').css({
                    width: flipbookWidth,
                    height: flipbookHeight
                });

                $('.flipbook').turn('size', flipbookWidth, flipbookHeight);
            }

            function setFlipbookDisplay() {
                if (window.innerWidth > window.innerHeight) {
                    $('.flipbook').turn('display', 'double');
                } else {
                    $('.flipbook').turn('display', 'single');
                }
            }

            $('.flipbook').turn({
                width: $(window).width(),
                height: $(window).height() - $('header').outerHeight(),
                autoCenter: true,
                display: 'single',
                gradients: true,
                elevation: 50,
                acceleration: true,
                when: {
                    turned: function(event, page, view) {
                        $('#current-page').text(page);
                    }
                }
            });

            $(window).resize(function() {
                resizeFlipbook();
                setFlipbookDisplay();
            });

            setFlipbookDisplay();
            resizeFlipbook();

            // Fullscreen toggle
            document.getElementById('fullscreen-toggle').addEventListener('click', function() {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen();
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    }
                }
            });

            document.addEventListener('fullscreenchange', function() {
                if (document.fullscreenElement) {
                    header.style.display = 'none';
                    controls.style.display = 'none';
                } else {
                    header.style.display = 'block';
                    controls.style.display = 'flex';
                }
                resizeFlipbook();
                setFlipbookDisplay();
            });

            // Navigation buttons
            document.getElementById('prev').addEventListener('click', function() {
                $('.flipbook').turn('previous');
            });

            document.getElementById('next').addEventListener('click', function() {
                $('.flipbook').turn('next');
            });

            // Toggle header and controls on touch/click
            function toggleControls() {
                if (isControlsVisible) {
                    header.style.display = 'none';
                    controls.style.display = 'none';
                } else {
                    header.style.display = 'block';
                    controls.style.display = 'flex';
                }
                isControlsVisible = !isControlsVisible;
                resizeFlipbook();
                setFlipbookDisplay();
            }

            // Adding touchstart and click event listeners to the overlay
            overlay.addEventListener('touchstart', function(event) {
                // Prevent default touch action to avoid conflict with other events
                event.preventDefault();
                toggleControls();
            });

            overlay.addEventListener('click', function(event) {
                // Prevent default action for clicks within the toggle area
                event.preventDefault();
                toggleControls();
            });
        });
    </script>
</body>
</html>
